var _=Object.defineProperty;var b=(o,t,e)=>t in o?_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var m=(o,t,e)=>b(o,typeof t!="symbol"?t+"":t,e);import{_ as n}from"./index-Xwsh00MR.js";import v from"mongoose";const f={BASE_URL:"/visual-builder-bliss/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_MONGODB_URI:"mongodb+srv://beinghomeindia_db_user:61T4qaiJJNaCdRbo@cluster0.dldoreq.mongodb.net/visual-builder-bliss",VITE_USER_NODE_ENV:"development"};var w={};const y=typeof import.meta<"u"&&f?"mongodb+srv://beinghomeindia_db_user:61T4qaiJJNaCdRbo@cluster0.dldoreq.mongodb.net/visual-builder-bliss":typeof process<"u"&&w&&w.MONGODB_URI||"mongodb+srv://beinghomeindia_db_user:61T4qaiJJNaCdRbo@cluster0.dldoreq.mongodb.net/visual-builder-bliss";if(!y)throw new Error("Please define the MONGODB_URI or VITE_MONGODB_URI environment variable");const d=(()=>{if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object")})();let s=d.mongoose||{conn:null,promise:null};d.mongoose||(d.mongoose=s);async function R(){if(s.conn)return s.conn;if(!s.promise){const o={bufferCommands:!1,dbName:"visual-builder-bliss"};s.promise=v.connect(y,o)}try{return s.conn=await s.promise,console.log("‚úÖ Connected to MongoDB"),s.conn}catch(o){throw s.promise=null,console.error("‚ùå MongoDB connection error:",o),o}}const c=class c{constructor(){}static getInstance(){return c.instance||(c.instance=new c),c.instance}async init(){try{await R(),console.log("Database service initialized")}catch(t){throw console.error("Failed to initialize database:",t),t}}async createRecipe(t){await this.init();const{Recipe:e}=await n(async()=>{const{Recipe:i}=await import("./index-BdP-CsbA.js");return{Recipe:i}},[]);return await new e(t).save()}async getRecipe(t){await this.init();const{Recipe:e}=await n(async()=>{const{Recipe:a}=await import("./index-BdP-CsbA.js");return{Recipe:a}},[]);return await e.findById(t).populate("createdBy","username avatar")}async getRecipes(t){await this.init();const{Recipe:e}=await n(async()=>{const{Recipe:i}=await import("./index-BdP-CsbA.js");return{Recipe:i}},[]),a=e.find({isPublished:!0});return t!=null&&t.category&&a.where({category:t.category}),t!=null&&t.sortBy?t.sortBy==="popular"?a.sort({viewCount:-1,rating:-1}):t.sortBy==="recent"?a.sort({createdAt:-1}):t.sortBy==="rating"&&a.sort({rating:-1}):a.sort({createdAt:-1}),t!=null&&t.skip&&a.skip(t.skip),t!=null&&t.limit&&a.limit(t.limit),await a.populate("createdBy","username avatar")}async updateRecipe(t,e){await this.init();const{Recipe:a}=await n(async()=>{const{Recipe:i}=await import("./index-BdP-CsbA.js");return{Recipe:i}},[]);return await a.findByIdAndUpdate(t,e,{new:!0})}async deleteRecipe(t){await this.init();const{Recipe:e}=await n(async()=>{const{Recipe:i}=await import("./index-BdP-CsbA.js");return{Recipe:i}},[]);return!!await e.findByIdAndDelete(t)}async incrementViewCount(t,e,a){await this.init();const{Recipe:i,ViewCount:r}=await n(async()=>{const{Recipe:g,ViewCount:h}=await import("./index-BdP-CsbA.js");return{Recipe:g,ViewCount:h}},[]);await new r({recipeId:t,userId:e,sessionId:a,viewedAt:new Date}).save();const u=await i.findByIdAndUpdate(t,{$inc:{viewCount:1}},{new:!0});return(u==null?void 0:u.viewCount)||0}async getViewCount(t){await this.init();const{Recipe:e}=await n(async()=>{const{Recipe:i}=await import("./index-BdP-CsbA.js");return{Recipe:i}},[]),a=await e.findById(t,"viewCount");return(a==null?void 0:a.viewCount)||0}async createUser(t){await this.init();const{User:e}=await n(async()=>{const{User:i}=await import("./index-BdP-CsbA.js");return{User:i}},[]);return await new e(t).save()}async getUser(t){await this.init();const{User:e}=await n(async()=>{const{User:a}=await import("./index-BdP-CsbA.js");return{User:a}},[]);return await e.findById(t)}async getUserByEmail(t){await this.init();const{User:e}=await n(async()=>{const{User:a}=await import("./index-BdP-CsbA.js");return{User:a}},[]);return await e.findOne({email:t.toLowerCase()})}async addToFavorites(t,e){await this.init();const{User:a}=await n(async()=>{const{User:r}=await import("./index-BdP-CsbA.js");return{User:r}},[]);return!!await a.findByIdAndUpdate(t,{$addToSet:{favoriteRecipes:e}})}async removeFromFavorites(t,e){await this.init();const{User:a}=await n(async()=>{const{User:r}=await import("./index-BdP-CsbA.js");return{User:r}},[]);return!!await a.findByIdAndUpdate(t,{$pull:{favoriteRecipes:e}})}async getSocialPosts(t=10){await this.init();const{SocialPost:e}=await n(async()=>{const{SocialPost:a}=await import("./index-BdP-CsbA.js");return{SocialPost:a}},[]);return await e.find({isActive:!0}).sort({postedAt:-1}).limit(t).populate("relatedRecipeId","title image")}async createSocialPost(t){await this.init();const{SocialPost:e}=await n(async()=>{const{SocialPost:i}=await import("./index-BdP-CsbA.js");return{SocialPost:i}},[]);return await new e(t).save()}async seedDatabase(){await this.init();const{Recipe:t,SocialPost:e}=await n(async()=>{const{Recipe:p,SocialPost:u}=await import("./index-BdP-CsbA.js");return{Recipe:p,SocialPost:u}},[]);if(await t.countDocuments()>0){console.log("Database already seeded");return}console.log("Seeding database with initial data...");const i=[{title:"Pasta with Vegetables",image:"https://images.unsplash.com/photo-1551183053-bf91a1d81141?w=400&h=300&fit=crop",rating:5,category:"Dinner",cookTime:"25 min",servings:4,calories:300,ingredients:[{name:"pasta",quantity:200,unit:"g"},{name:"zucchini",quantity:1,unit:"piece"},{name:"carrot",quantity:1,unit:"piece"},{name:"tomatoes",quantity:2,unit:"pieces"},{name:"olive oil",quantity:2,unit:"tbsp"},{name:"salt and pepper",quantity:0,unit:"to taste"},{name:"fresh herbs (basil, parsley)",quantity:0,unit:"to taste"}],instructions:["Cook pasta according to package instructions until al dente.","Meanwhile, dice the zucchini, carrot, and tomatoes.","Heat olive oil in a large pan over medium heat.","Add vegetables and cook for 5-7 minutes until tender.","Drain pasta and add to the pan with vegetables.","Toss everything together and season with salt and pepper.","Garnish with fresh herbs and serve hot."],videoUrl:"https://youtube.com/watch?v=dQw4w9WgXcQ",viewCount:156,difficulty:"Medium",cuisine:"Italian",tags:["healthy","vegetarian","quick"]},{title:"Healthy Breakfast Bowl",image:"https://images.unsplash.com/photo-1511690743698-d9d85f2fbf38?w=400&h=300&fit=crop",rating:4,category:"Breakfast",cookTime:"10 min",servings:2,calories:350,ingredients:[{name:"oats",quantity:100,unit:"g"},{name:"banana",quantity:1,unit:"piece"},{name:"berries",quantity:150,unit:"g"},{name:"yogurt",quantity:200,unit:"ml"},{name:"honey",quantity:2,unit:"tbsp"},{name:"nuts",quantity:30,unit:"g"}],instructions:["Cook oats according to package instructions.","Slice the banana into rounds.","In a bowl, layer the cooked oats.","Top with yogurt, banana slices, and berries.","Drizzle with honey and sprinkle with nuts.","Serve immediately and enjoy!"],videoUrl:"https://youtube.com/watch?v=dQw4w9WgXcQ",viewCount:89,difficulty:"Easy",cuisine:"International",tags:["healthy","breakfast","quick","nutritious"]},{title:"Mediterranean Salad",image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop",rating:4,category:"Lunch",cookTime:"15 min",servings:3,calories:250,ingredients:[{name:"mixed greens",quantity:200,unit:"g"},{name:"cherry tomatoes",quantity:150,unit:"g"},{name:"cucumber",quantity:1,unit:"piece"},{name:"feta cheese",quantity:100,unit:"g"},{name:"olives",quantity:50,unit:"g"},{name:"olive oil",quantity:3,unit:"tbsp"},{name:"lemon juice",quantity:2,unit:"tbsp"},{name:"oregano",quantity:1,unit:"tsp"}],instructions:["Wash and prepare all vegetables.","Cut cherry tomatoes in half and slice cucumber.","Combine greens, tomatoes, and cucumber in a large bowl.","Add crumbled feta cheese and olives.","Whisk olive oil, lemon juice, and oregano for dressing.","Pour dressing over salad and toss gently.","Serve immediately as a fresh, healthy meal."],viewCount:67,difficulty:"Easy",cuisine:"Mediterranean",tags:["healthy","vegetarian","fresh","light"]}];await t.insertMany(i);const r=[{platform:"instagram",user:"@recipemasters",content:"Check out this amazing pasta dish! üçù Simple ingredients, incredible flavor. What's your favorite comfort food?",likes:124,image:"https://images.unsplash.com/photo-1551183053-bf91a1d81141?w=400&h=300&fit=crop",postedAt:new Date(Date.now()-2*60*60*1e3)},{platform:"twitter",user:"@healthyeats",content:"Starting your morning right with this nutritious breakfast bowl! ü•£ Packed with oats, fresh fruits, and energy for the day ahead.",likes:89,image:"https://images.unsplash.com/photo-1511690743698-d9d85f2fbf38?w=400&h=300&fit=crop",postedAt:new Date(Date.now()-4*60*60*1e3)},{platform:"facebook",user:"Cooking Community",content:"Weekend cooking tip: Prep your ingredients in advance for stress-free weekday meals! What's your favorite meal prep hack?",likes:67,postedAt:new Date(Date.now()-24*60*60*1e3)}];await e.insertMany(r),console.log("‚úÖ Database seeded successfully with sample data")}};m(c,"instance");let l=c;const q=l.getInstance();export{l as DatabaseService,q as db};
